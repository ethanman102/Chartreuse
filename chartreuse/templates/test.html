{% extends "base.html" %}
{% load static %}

{% block title %}chartreuse.test{% endblock %}

{% block extra_head %}
    <style>
        html body {
            margin-left: 10%;
        }
    </style>

    <script type="module">
        // Consider switching to https://github.com/markdown-it/markdown-it?tab=readme-ov-file#markdown-it-
        // Their docs: https://markdown-it.github.io/markdown-it/
        // import markdownIt from 'https://cdn.jsdelivr.net/npm/markdown-it@14.1.0/+esm'
        
        import "https://unpkg.com/commonmark@0.29.3/dist/commonmark.js";

        'use strict'
        

        window.addEventListener('load', main);

        function main() {
            const commonmark = window.commonmark;

            // variable to track the html element for displaying the commonmark text
            var markString = document.getElementById('cm_content').innerText;

        
            // will need to bundle with esbuild command for the browser import mini package
            var reader = new commonmark.Parser({smart: true});
            var writer = new commonmark.HtmlRenderer({sourcepos: true, softbreak: "<br />"});
            // var writer = new commonmark.HtmlRenderer({sourcepos: true, safe: true, softbreak: "<br />"});
            var parsed = reader.parse(markString); // parsed is a 'Node' tree
            // transform parsed if you like...
            var result = writer.render(parsed); // result is a String

            
            // // sets the text to be shown in html file as the rendered Commonmark text 
            document.getElementById('cm_content').innerHTML = result;
        };

        
    </script>

{% endblock %}

{% block content %}

    {% block sidenav %}
        {% include 'navbar.html' %}
    {% endblock %}
   
    <h2>chartreuse.test</h2>

    
    <p># This is testing</p>

    <!-- Seems like I can just put the rendered  -->
    <p class="card-text" id="cm_content">{{ markdown_txt }}</p>

    <!-- First attempt to get commonmark to show up -->
    <!-- <p class="card-text" id="cm_content" style="display: none;">{{ markdown_txt }}</p> -->
    
    <!-- testing rendered commonmark text shows here -->
    <!-- <p id="cm_text"></p> -->

{% endblock %}